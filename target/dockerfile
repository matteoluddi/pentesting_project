FROM kalilinux/kali-last-release
#Update + Upgrade
RUN apt-get update && apt-get upgrade -y
#Install Tools
RUN apt-get install -y openssh-server && apt-get clean
#Enable remote root login
RUN echo 'PermitRootLogin yes' >> /etc/ssh/sshd_config
#Set root password for remote login
RUN echo 'root:ThisIsADifficultPwd00!' | chpasswd
#Create a new user
RUN useradd -m -d /home/newuser -s /bin/bash newuser
RUN echo 'newuser:rogerrabbit' | chpasswd
RUN mkdir /home/newuser/.ssh
RUN touch /home/newuser/.ssh/authorized_keys
RUN chown -R newuser:newuser /home/newuser/.ssh
RUN chmod 700 /home/newuser/.ssh
RUN chmod 600 /home/newuser/.ssh/authorized_keys
#Start the ssh service
ENTRYPOINT service ssh restart && bash